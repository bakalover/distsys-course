# Контейнер для курса

Работоспособность проверена на Ubuntu 18.04.
На более старых версиях работа не гарантируется.

## Зависимости

### Linux

```shell
sudo apt install -y docker docker-compose bash
sudo groupadd docker
sudo usermod -aG docker $USER
```

После этого потребуется перезапустить текущую сессию (или просто перезагрузить машину).

Убедитесь, что Докер успешно установился и работает:
```shell
docker run hello-world
```

### OS X

Скачайте, установите и запустите (в тулбаре появится значок с китом) [Docker Desktop](https://download.docker.com/mac/stable/Docker.dmg).

## Создание контейнера

Запустите в хост-системе скрипт `create` из `docker/client/bin`.

Созданный контейнер будет называться так же, как и репозиторий курса.

Директория с репозиторием курса монтируется в контейнер по пути `/workspace`.

## Логин в контейнер

Запустите в хост-системе скрипт `login` из `docker/client/bin`.

Вы успешно вошли в контейнер, если видите приветствие:
```
Hi, ${USERNAME}!
Welcome to Docker container 'distsys-course'!
(___-){
===================================

Type 'exit' to exit =)
```

Логиниться в контейнер необходимо для работы с клиентом,
редактировать файлы можно и снаружи (для этого рекомендуется использовать CLion).

Работайте с контейнером под тем пользователем, под которым проводили установку!


## Выход из контейнера

Для выхода из контейнера в терминале нужно выполнить команду `exit`.

## Перезапуск контейнера

Запустите в хост-системе скрипт `restart` из `docker/client/bin`.

Может быть полезно, если вы выключите компьютер / исчезнет контейнер / случится еще какая-то магия.

## Рабочая директория

При создании контейнера рабочая директория, в которую был склонирован репозиторий курса, монтируется в контейнере в директорию `/workspace`.

Все изменения, которые вы сделаете в директории `/workspace` в контейнере, будут видны в хост-системе. И наоборот: если вы редактируете файлы в IDE в хост-системе, то изменения будут видны и внутри контейнера.

Всегда безопасно удалить и пересоздать контейнер: все изменения, сделанные в директории `/workspace`, хранятся в хост-системе и попадут в контейнер при его пересоздании.

## `.bashrc`

По умолчанию при логине в контейнер вы оказываетесь в корне репозитория курса.

Если вы хотите изменить точку входа (например, прыгать при логине сразу в `tasks`), то поменяйте в хост-системе файл [`docker/config/bashrc`](/docker/config/bashrc).
